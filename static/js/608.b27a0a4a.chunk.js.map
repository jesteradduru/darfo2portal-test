{"version":3,"file":"static/js/608.b27a0a4a.chunk.js","mappings":"2TAeMA,EAAIC,EAAQ,KA8JlB,UA5Je,WACb,IAAQC,GAAgBC,EAAAA,EAAAA,MAAhBD,YACR,GAAsCE,EAAAA,EAAAA,UAAS,IAA/C,eAAOC,EAAP,KAAoBC,EAApB,KACA,GAA2CF,EAAAA,EAAAA,WAAS,GAApD,eAAOG,EAAP,KAAwBC,EAAxB,KACMC,GAAWC,EAAAA,EAAAA,MACjB,GAAsCC,EAAAA,EAAAA,KACpC,SAACC,GAAD,OAAWA,EAAMC,aAAjB,IADMC,EAAR,EAAQA,eAAgBC,EAAxB,EAAwBA,UAGxB,GAAsDX,EAAAA,EAAAA,UAAS,IAA/D,eAAOY,EAAP,KAA4BC,EAA5B,KAOMC,EAAsB,SAACC,GAC3B,OAAInB,EAAEoB,QAAQf,GACLc,GAGL,SAAC,IAAD,CACEE,mBAAmB,aACnBC,YAAa,CAACjB,GACdkB,YAAY,EACZC,gBAAiBL,GAIxB,EAEKM,EAAU,CACd,CACEC,KAAM,aACNC,SAAU,SAACC,GAAD,OAASA,EAAIC,aAAb,EACVC,MAAM,EACNC,KAAM,SAACH,GACL,OAAOV,EAAoBU,EAAIC,cAChC,GAEH,CACEH,KAAM,iBACNC,SAAU,SAACC,GAAD,gBAAYA,EAAII,SAAhB,YAA4BJ,EAAIK,WAAhC,EACVH,MAAM,EACNC,KAAM,SAACH,GAAD,OAASV,EAAoB,GAAD,OAAIU,EAAII,SAAR,YAAoBJ,EAAIK,YAApD,GAER,CACEP,KAAM,UACNC,SAAU,SAACC,GAAD,OAASA,EAAIM,WAAb,EACVJ,MAAM,EACNC,KAAM,SAACH,GAAD,OAASV,EAAoBU,EAAIM,YAAjC,GAER,CACER,KAAM,SACNK,KAAM,SAACH,GAAD,OACJV,EAAoB,GAAD,OACdU,EAAIO,gBADU,aACUP,EAAIQ,oBADd,aACsCR,EAAIS,mBAFzD,GAMR,CACEX,KAAM,gBACNC,SAAU,SAACC,GAAD,OAASA,EAAIU,gBAAb,EACVP,KAAM,SAACH,GAAD,OACJV,EACEqB,IAAOX,EAAIU,kBAAkBE,OAAO,sBAFlC,EAINC,UAAU,KAIdC,EAAAA,EAAAA,YAAU,WACRzB,EAAuBH,EACxB,GAAE,CAACA,IAEJ,IAAM6B,EAAe7B,EAAe8B,QAAO,SAACC,GAC1C,OACEA,EAAIhB,cACDiB,cACAC,SAAS1C,EAAY2C,sBACxBH,EAAIX,YAAYY,cAAcC,SAAS1C,EAAY2C,sBACnD,UAAGH,EAAIV,gBAAP,aAA2BU,EAAIT,oBAA/B,aAAuDS,EAAIR,mBACxDS,cACAC,SAAS1C,EAAY2C,sBACxB,UAAGH,EAAII,cAAP,YAAwBJ,EAAIK,aAA5B,cAA8CL,EAAIM,aAC/CL,cACAC,SAAS1C,EAAY2C,sBACxB,UAAGH,EAAIb,SAAP,YAAmBa,EAAIZ,YACpBa,cACAC,SAAS1C,EAAY2C,sBACxBT,IAAOM,EAAIP,kBACRE,OAAO,sBACPM,cACAC,SAAS1C,EAAY2C,oBAE3B,IAEKI,EAAS,mCAAG,WAAOC,GAAP,iEAChB5C,GAAS6C,EAAAA,EAAAA,GAASD,IAClB7C,GAAiBD,GAFD,2CAAH,sDAYf,OAPAmC,EAAAA,EAAAA,YAAU,WACRjC,GAAS8C,EAAAA,EAAAA,MACV,GAAE,CAAC9C,KAMF,UAAC,KAAD,CAAW+C,UAAU,OAArB,WACE,SAAC,KAAD,CACEC,YAAalD,EACbmD,YAAalD,KAEf,UAAC,KAAD,YACE,wBAAqB,UAAhBN,EAA0B,eAAiB,qBAChD,SAAC,KAAD,CAAKyD,GAAG,KAAR,UACE,SAAC,KAAD,UACmB,UAAhBzD,GACC,SAAC,KAAD,CAAKyD,GAAG,IAAR,UACE,SAAC,KAAD,CACEC,YAAa,SACbJ,UAAU,OACVK,oBAhHY,SAACC,GAC3BxD,EAAewD,EAAEC,OAAOC,MACzB,EA+Ge3D,YAAaA,EACb4D,YAAa,kBAAM3D,EAAe,GAArB,OAIjB,SAAC,KAAD,WACE,SAAC,KAAD,CAAkB4D,YAAajD,EAAwBH,eAAgBA,WAK/E,UAAC,KAAD,YACE,gBAAK0C,UAAU,UAEf,SAAC,KAAD,CACE/B,QAASA,EACT0C,KAAsB,aAAhBjE,EAA6Bc,EAAsB2B,EACzDyB,kBAAgB,EAChBC,YAAU,EACVC,aAAc,SAAC1C,GAAD,OAASwB,EAAUxB,EAAIyB,OAAvB,EACdkB,gBAAc,EACdC,gBAAiBzD,EACjB0D,mBAAmB,SAAC,KAAD,IACnBC,kBAAgB,YAO3B,C","sources":["Pages/DTS/Search/Search.jsx"],"sourcesContent":["// Basic and Advanced Search Page\r\nimport React, { useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nimport DataTable from \"react-data-table-component\";\r\nimport Highlighter from \"react-highlight-words\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport { Col, Container, Row, Spinner } from \"reactstrap\";\r\nimport { ContentSearch } from \"../../../Layouts/Portal\";\r\nimport moment from \"moment\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { getCommunications } from \"../../../features/dts/communications/communications\";\r\nimport { AdvanceSearchBar, ViewTrailModal } from \"../../../Layouts/DTS\";\r\nimport { getTrail } from \"../../../features/dts/trail/trailSlice\";\r\nimport \"react-data-table-component-extensions/dist/index.css\";\r\n\r\nconst _ = require(\"lodash\");\r\n\r\nconst Search = () => {\r\n  const { search_type } = useParams();\r\n  const [searchValue, setSearchValue] = useState(\"\");\r\n  const [isViewTrailOpen, toggleViewTrail] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const { communications, isLoading } = useSelector(\r\n    (state) => state.communication\r\n  );\r\n  const [advanceSearchResult, setAdvanceSearchResult] = useState([])\r\n\r\n  \r\n  const onSearchValueChange = (e) => {\r\n    setSearchValue(e.target.value);\r\n  };\r\n\r\n  const highlightMatchWords = (rowToMatch) => {\r\n    if (_.isEmpty(searchValue)) {\r\n      return rowToMatch;\r\n    } else {\r\n      return (\r\n        <Highlighter\r\n          highlightClassName=\"bg-warning\"\r\n          searchWords={[searchValue]}\r\n          autoEscape={true}\r\n          textToHighlight={rowToMatch}\r\n        />\r\n      );\r\n    }\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      name: \"Control No\",\r\n      selector: (row) => row.com_controlNo,\r\n      wrap: true,\r\n      cell: (row) => {\r\n        return highlightMatchWords(row.com_controlNo);\r\n      },\r\n    },\r\n    {\r\n      name: \"Classification\",\r\n      selector: (row) => `${row.cat_name} ${row.class_name}`,\r\n      wrap: true,\r\n      cell: (row) => highlightMatchWords(`${row.cat_name} ${row.class_name}`),\r\n    },\r\n    {\r\n      name: \"Subject\",\r\n      selector: (row) => row.com_subject,\r\n      wrap: true,\r\n      cell: (row) => highlightMatchWords(row.com_subject),\r\n    },\r\n    {\r\n      name: \"Source\",\r\n      cell: (row) =>\r\n        highlightMatchWords(\r\n          `${row.com_source_name}, ${row.com_source_position}, ${row.com_source_office}`\r\n        ),\r\n    },\r\n\r\n    {\r\n      name: \"Date Received\",\r\n      selector: (row) => row.com_dateReceived,\r\n      cell: (row) =>\r\n        highlightMatchWords(\r\n          moment(row.com_dateReceived).format(\"dddd, MMMM Do YYYY\")\r\n        ),\r\n      sortable: true,\r\n    },\r\n  ];\r\n\r\n  useEffect(() => {\r\n    setAdvanceSearchResult(communications)\r\n  }, [communications])\r\n\r\n  const filteredData = communications.filter((com) => {\r\n    return (\r\n      com.com_controlNo\r\n        .toLowerCase()\r\n        .includes(searchValue.toLocaleLowerCase()) ||\r\n      com.com_subject.toLowerCase().includes(searchValue.toLocaleLowerCase()) ||\r\n      `${com.com_source_name}, ${com.com_source_position}, ${com.com_source_office}`\r\n        .toLowerCase()\r\n        .includes(searchValue.toLocaleLowerCase()) ||\r\n      `${com.emp_firstname} ${com.emp_lastname} - ${com.office_code}`\r\n        .toLowerCase()\r\n        .includes(searchValue.toLocaleLowerCase()) ||\r\n      `${com.cat_name} ${com.class_name}`\r\n        .toLowerCase()\r\n        .includes(searchValue.toLocaleLowerCase()) ||\r\n      moment(com.com_dateReceived)\r\n        .format(\"dddd, MMMM Do YYYY\")\r\n        .toLowerCase()\r\n        .includes(searchValue.toLocaleLowerCase())\r\n    );\r\n  });\r\n\r\n  const viewTrail = async (com_id) => {\r\n    dispatch(getTrail(com_id));\r\n    toggleViewTrail(!isViewTrailOpen);\r\n  };\r\n\r\n  useEffect(() => {\r\n    dispatch(getCommunications());\r\n  }, [dispatch]);\r\n\r\n  // useEffect(() => {\r\n  //   console.log(advanceSearchResult)\r\n  // }, [advanceSearchResult])\r\n  return (\r\n    <Container className=\"mt-3\">\r\n      <ViewTrailModal\r\n        isModalOpen={isViewTrailOpen}\r\n        toggleModal={toggleViewTrail}\r\n      />\r\n      <Row>\r\n        <h3>{search_type === \"basic\" ? \"Basic Search\" : \"Advanced Search\"}</h3>\r\n        <Col md=\"12\">\r\n          <Row>\r\n            {search_type === \"basic\" ? (\r\n              <Col md=\"6\">\r\n                <ContentSearch\r\n                  placeholder={\"Search\"}\r\n                  className=\"mb-3\"\r\n                  onSearchValueChange={onSearchValueChange}\r\n                  searchValue={searchValue}\r\n                  clearSearch={() => setSearchValue(\"\")}\r\n                />\r\n              </Col>\r\n            ) : (\r\n              <Col>\r\n                <AdvanceSearchBar onFilterCom={setAdvanceSearchResult} communications={communications} />\r\n              </Col>\r\n            )}\r\n          </Row>\r\n        </Col>\r\n        <Col>\r\n          <div className=\"mt-2\"></div>\r\n          {/* <DataTableExtensions columns={columns} data={search_type === 'advanced' ? advanceSearchResult : filteredData} filter={false} exportHeaders={true}> */}\r\n          <DataTable\r\n            columns={columns}\r\n            data={search_type === 'advanced' ? advanceSearchResult : filteredData}\r\n            highlightOnHover\r\n            pagination\r\n            onRowClicked={(row) => viewTrail(row.com_id)}\r\n            pointerOnHover\r\n            progressPending={isLoading}\r\n            progressComponent={<Spinner />}\r\n            persistTableHead\r\n          />\r\n          {/* </DataTableExtensions> */}\r\n        </Col>\r\n      </Row>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default Search;\r\n"],"names":["_","require","search_type","useParams","useState","searchValue","setSearchValue","isViewTrailOpen","toggleViewTrail","dispatch","useDispatch","useSelector","state","communication","communications","isLoading","advanceSearchResult","setAdvanceSearchResult","highlightMatchWords","rowToMatch","isEmpty","highlightClassName","searchWords","autoEscape","textToHighlight","columns","name","selector","row","com_controlNo","wrap","cell","cat_name","class_name","com_subject","com_source_name","com_source_position","com_source_office","com_dateReceived","moment","format","sortable","useEffect","filteredData","filter","com","toLowerCase","includes","toLocaleLowerCase","emp_firstname","emp_lastname","office_code","viewTrail","com_id","getTrail","getCommunications","className","isModalOpen","toggleModal","md","placeholder","onSearchValueChange","e","target","value","clearSearch","onFilterCom","data","highlightOnHover","pagination","onRowClicked","pointerOnHover","progressPending","progressComponent","persistTableHead"],"sourceRoot":""}