"use strict";(self.webpackChunkda_rfo_02_portal=self.webpackChunkda_rfo_02_portal||[]).push([[215],{3490:function(e,c,n){n.r(c),n.d(c,{default:function(){return C}});var t=n(5861),r=n(885),s=n(7757),i=n.n(s),a=n(2791),o=n(9051),l=n(1405),d=n(3673),u=n(2426),h=n.n(u),_=n(2982),f=n(7161),x=n(184),j=function(e){var c=e.setTitle,n=e.setCalendarState,t=e.calendarState,r=e.reportFields,s=e.setFields,i=e.setClassCode,a=e.loadReport,d=(0,l.v9)((function(e){return e.classifications})).classifications.map((function(e,c){return(0,x.jsxs)("option",{value:e.class_code,children:[e.class_name," - ",e.cat_name]},c)})),u=function(e){var c=e.target;if("select_all"===c.value&&!0===c.checked)return s(["control_no","classification","source","subject","referred_to","date_received","action_desired","action_taken","status"]);if("select_all"===c.value)return s([]);if(!0===c.checked)s([].concat((0,_.Z)(r),[e.target.value]));else{var n=r.filter((function(c){return c!==e.target.value}));s(n)}};return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(o.__,{for:"report_title",children:"Report Type"}),(0,x.jsx)("div",{children:(0,x.jsxs)(o.cw,{check:!0,inline:!0,children:[(0,x.jsx)(o.II,{type:"radio",id:"monitoring",name:"report_type",onChange:function(e){return c(e.target.value)},defaultChecked:!0}),(0,x.jsx)(o.__,{for:"monitoring",children:"Monitoring"})]})}),(0,x.jsx)(o.Zb,{children:(0,x.jsxs)(o.eW,{children:[(0,x.jsxs)(o.cw,{children:[(0,x.jsx)(o.__,{children:"Filter by classification:"}),(0,x.jsxs)(o.II,{type:"select",onChange:function(e){i(e.target.value)},children:[(0,x.jsx)("option",{value:"",children:"None"}),d]})]}),(0,x.jsxs)(o.__,{children:["Fields: ",(0,x.jsx)("span",{className:"text-danger",children:"*"})]}),(0,x.jsxs)(o.X2,{children:[(0,x.jsxs)(o.JX,{children:[(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"select_all",onChange:u}),(0,x.jsx)(o.__,{check:!0,children:"Select All"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"control_no",onChange:u,checked:r.includes("control_no")}),(0,x.jsx)(o.__,{check:!0,children:"Control No"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"classification",onChange:u,checked:r.includes("classification")}),(0,x.jsx)(o.__,{check:!0,children:"Classification"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"source",onChange:u,checked:r.includes("source")}),(0,x.jsx)(o.__,{check:!0,children:"Source"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"subject",onChange:u,checked:r.includes("subject")}),(0,x.jsx)(o.__,{check:!0,children:"Subject"})]})]}),(0,x.jsxs)(o.JX,{children:[(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"referred_to",onChange:u,checked:r.includes("referred_to")}),(0,x.jsx)(o.__,{check:!0,children:"Referred To"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"date_received",onChange:u,checked:r.includes("date_received")}),(0,x.jsx)(o.__,{check:!0,children:"Date Received"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"action_desired",onChange:u,checked:r.includes("action_desired")}),(0,x.jsx)(o.__,{check:!0,children:"Action Desired"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"action_taken",onChange:u,checked:r.includes("action_taken")}),(0,x.jsx)(o.__,{check:!0,children:"Action Taken"})]}),(0,x.jsxs)(o.cw,{check:!0,children:[(0,x.jsx)(o.II,{type:"checkbox",value:"status",onChange:u,checked:r.includes("status")}),(0,x.jsx)(o.__,{check:!0,children:"Status"})]})]})]})]})}),(0,x.jsxs)(o.cw,{className:"d-flex flex-column",children:[(0,x.jsx)(o.__,{for:"report_date_range",children:"Date Range"}),(0,x.jsx)(f.C0,{editableDateInputs:!0,onChange:function(e){return n([e.selection])},moveRangeOnFirstSelection:!1,ranges:t})]}),(0,x.jsx)(o.zx,{color:"success",className:"mx-auto d-block",onClick:a,children:"Generate Report"})]})},m=n(3513),k=n(5004),p=(n(5106),n(6683)),v=n(6871),g=n(763),C=function(){var e=(0,l.I0)(),c=(0,v.UO)().com_ids,n=(0,l.v9)((function(e){return e.reports})),s=n.reports,u=n.isLoading,_=(0,a.useState)(""),f=(0,r.Z)(_,2),C=f[0],I=f[1],y=(0,a.useState)([]),b=(0,r.Z)(y,2),w=b[0],D=b[1],S=(0,a.useState)([]),E=(0,r.Z)(S,2),R=E[0],N=E[1],A=(0,a.useState)([{startDate:new Date,endDate:new Date,key:"selection"}]),Y=(0,r.Z)(A,2),T=Y[0],F=Y[1],O=[{name:"CONTROL NO",selector:"com_controlNo",sortable:!0,key:"control_no",omit:!R.includes("control_no"),wrap:!0},{name:"CLASSIFICATION",cell:function(e){return"".concat(e.class_name," ").concat(e.cat_name)},omit:!R.includes("classification"),key:"classification"},{name:"SOURCE (NAME, POSITION, OFFICE)",cell:function(e){return"".concat(e.com_source_name,", ").concat(e.com_source_position,", ").concat(e.com_source_office)},omit:!R.includes("source"),key:"source"},{name:"SUBJECT",selector:"com_subject",omit:!R.includes("subject"),key:"subject",wrap:!0},{name:"REFFERED TO",omit:!R.includes("referred_to"),cell:function(e){var c=[],n=e.referred_to.map((function(e){return!c.includes(e.fullname)&&e.role_name.includes("Approver")&&e.routing_legend.includes("for_action")?(c.push(e.fullname),(0,x.jsx)("li",{children:e.fullname})):(0,x.jsx)(x.Fragment,{})}));return(0,x.jsx)("ul",{style:{padding:"0"},children:n})},key:"referred_to"},{name:"DATE RECEIVED (DD-MM-YYYY)",selector:"com_dateReceived",cell:function(e){return h()(e.com_dateReceived).format("DD-MM-YYYY")},sortable:!0,omit:!R.includes("date_received"),key:"date_received"},{name:"STATUS",cell:function(e){var c=e.action_taken.filter((function(e){return"for_review"===e.act_status})),n=e.action_taken.filter((function(e){return"approved"===e.act_status}));return g.isEmpty(c)?g.isEmpty(n)?"Pending Action":"Complied":"Action for approval"},sortable:!0,omit:!R.includes("status"),key:"status"},{name:"ACTION DESIRED",omit:!R.includes("action_desired"),cell:function(e){if(g.isEmpty(e.action_desired))return"";var c=e.action_desired.filter((function(e){return e.routing_legend.includes("for_action")})).map((function(e){var c=["FYAA"];return e.routing_legend.includes("rush")?c.push("Rush"):e.routing_legend.includes("urgent")&&c.push("Urgent"),(0,x.jsx)("li",{children:c.join("/")+"/".concat(e.routing_remarks)})}));return(0,x.jsx)("ul",{children:c})},key:"action_desired"},{name:"ACTION TAKEN",omit:!R.includes("action_taken"),cell:function(e){var c=e.action_taken.map((function(e){return(0,x.jsx)("li",{children:e.act_taken})}));return(0,x.jsx)("ul",{style:{padding:"0"},children:c})},key:"action_taken"}],M=O.filter((function(e){return R.includes(e.key)})),Z=function(){var c=(0,t.Z)(i().mark((function c(){var n;return i().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(g.isEmpty(R)){c.next=7;break}return c.next=3,e((0,d.QL)());case 3:n=s.filter((function(e){var c=h()(T[0].startDate).format("MM-DD-YYYY"),n=h()(T[0].endDate).format("MM-DD-YYYY");return h()(c).isSameOrBefore(e.com_dateReceived)&&h()(n).isSameOrAfter(e.com_dateReceived)&&e.com_controlNo.includes(C)})),D(n),c.next=8;break;case 7:D([]);case 8:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();return(0,a.useEffect)((function(){if(!g.isUndefined(c)){var e=s.filter((function(e){return c.includes(e.com_id)||"all"===c&&g.isEmpty(e.action_taken)}));N(["control_no","classification","source","subject","referred_to","date_received","action_desired","action_taken","status"]),D(e)}}),[]),(0,a.useEffect)((function(){e((0,p.bn)())}),[]),(0,x.jsxs)(o.W2,{fluid:!0,className:"mt-3",children:[(0,x.jsx)("h3",{children:"Reports"}),(0,x.jsxs)(o.X2,{children:[(0,x.jsx)(o.JX,{md:"3",children:(0,x.jsx)(j,{calendarState:T,setCalendarState:F,reportFields:R,setFields:N,setClassCode:I,loadReport:Z})}),(0,x.jsx)(o.JX,{md:"9",children:(0,x.jsx)("div",{className:"p-2 shadow",children:(0,x.jsx)(k.Z,{data:w,filter:!1,columns:M,exportHeaders:!0,fileName:"dts_report_".concat(h()().format()),children:(0,x.jsx)(m.ZP,{data:w,columns:O,pagination:!0,progressPending:u,progressComponent:(0,x.jsx)(o.$j,{}),persistTableHead:!0})})})})]})]})}}}]);
//# sourceMappingURL=215.88e06462.chunk.js.map