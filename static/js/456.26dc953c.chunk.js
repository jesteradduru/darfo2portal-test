"use strict";(self.webpackChunkda_rfo_02_portal=self.webpackChunkda_rfo_02_portal||[]).push([[456],{5181:function(e,s,n){n.r(s);var t=n(5861),c=n(4942),a=n(1413),r=n(885),i=n(7757),d=n.n(i),o=n(2791),l=n(9051),u=n(2966),m=n(1405),x=n(6683),h=n(8230),j=n(5617),f=n(2426),_=n.n(f),p=n(556),g=n(3504),b=n(184),v=n(763);s.default=function(e){e.socket;var s=(0,m.I0)(),n=(0,m.v9)((function(e){return e.classifications})).classifications,i=(0,m.v9)((function(e){return e.user.user})),f=i.user_id,y=i.office_code,I=(0,m.v9)((function(e){return e.communication})),S=I.newAddedCommunication,N=I.isControlNoExist,w=I.addLoading,X=(0,o.useState)(!1),C=(0,r.Z)(X,2),Z=C[0],A=C[1],J=(0,o.useState)(""),z=(0,r.Z)(J,2),E=z[0],M=z[1],O=(0,o.useState)(null),k=(0,r.Z)(O,2),L=k[0],D=k[1],G=(0,o.useState)({scanned:!1,attachments:!1}),P=(0,r.Z)(G,2),R=P[0],F=P[1],Y=function(){var e=U()+document.getElementById("control_no").value;s((0,p.sl)(e))},q=function(e){var s=e.target,n=s.getAttribute("name");v.isEmpty(s.files)?F((0,a.Z)((0,a.Z)({},R),{},(0,c.Z)({},n,!1))):s.files[0].size>25e6?F((0,a.Z)((0,a.Z)({},R),{},(0,c.Z)({},n,!0))):F((0,a.Z)((0,a.Z)({},R),{},(0,c.Z)({},n,!1)))},U=function(){var e="DARFO2.".concat(y);return e+=""!==E&&null!=E?"."+E:".00-0",e+="-"+_()().format("YY-MM")+"-"},T=n.map((function(e,s){return(0,b.jsxs)("option",{value:e.class_id,"data-classcode":"".concat(e.class_code),children:[e.class_name," - ",e.cat_name]},s)})),B=function(){var e=(0,t.Z)(d().mark((function e(){var n;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData(document.querySelector("#add_communication_form")),n.get("control_no"),n.append("user_id",f),n.append("draft","true"),n.set("control_no",U()),e.next=7,s((0,h.uN)(n)).then((function(){document.querySelector("#add_communication_form").reset(),s((0,h.Oe)(f))}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=(0,t.Z)(d().mark((function e(n){var t,c,a;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),t=new FormData(n.target),t.get("control_no"),t.append("user_id",f),t.set("control_no",U()),e.next=7,s((0,p.dZ)(t));case 7:if(!(c=e.sent).payload.communication||"com_duplicate"===c.payload){e.next=17;break}return alert("Added Succesfully!"),e.next=12,s((0,p.IG)(c.payload.communication));case 12:a=e.sent,v.isEmpty(a.payload)||A(!Z),n.target.reset(),e.next=18;break;case 17:alert("Subject of the communication is duplicated");case 18:case"end":return e.stop()}}),e)})));return function(s){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){s((0,x.bn)())}),[s]),(0,o.useEffect)((function(){Y()}),[E]),(0,b.jsx)(l.W2,{className:"mt-3",children:(0,b.jsxs)(l.l0,{id:"add_communication_form",onSubmit:W,children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,b.jsx)("h3",{children:"Add Communication"}),(0,b.jsx)(u.Z,{})]}),(0,b.jsx)(j.tn,{isModalOpen:Z,toggleModal:function(){A(!Z),s((0,p.mc)())},com_id:S}),(0,b.jsxs)(l.X2,{children:[(0,b.jsx)(l.JX,{md:"6",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsxs)(l.__,{for:"control_no",children:["Control No. ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsxs)(l.BZ,{size:"sm",children:[(0,b.jsx)(l.O3,{children:U()}),(0,b.jsx)(l.II,{id:"control_no",name:"control_no",type:"text",invalid:N,onChange:Y,disabled:!0,defaultValue:"[AUTO]"}),(0,b.jsx)(l.AG,{children:"Control number already exist!"})]})]})}),(0,b.jsx)(l.JX,{md:"6",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsxs)("div",{className:"d-flex",children:[(0,b.jsxs)(l.__,{for:"class_id",children:["Classification ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsx)(g.rU,{to:"/dts/managementOfCommunications/classifications",className:"ms-auto",children:"Management of Classifications"})]}),(0,b.jsxs)(l.II,{bsSize:"sm",id:"class_id",name:"class_id",type:"select",onChange:function(){var e=document.getElementById("class_id"),s=e.options[e.selectedIndex],t=s.getAttribute("value"),c=n.filter((function(e){return e.class_id===parseInt(t)}));c[0]&&c[0].class_due>0?D(_()().add(c[0].class_due,"d").format("YYYY-MM-DD")):D(null),M(s.getAttribute("data-classcode"))},required:!0,children:[(0,b.jsx)("option",{"data-classcode":"00-0",value:"",children:"Select classification"}),T]})]})}),(0,b.jsx)(l.JX,{md:"6",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsx)(l.__,{for:"due_date",children:"Due Date"}),(0,b.jsx)(l.II,{bsSize:"sm",id:"due_date",name:"due_date",type:"date",onChange:function(e){D(e.target.value)},value:v.isNull(L)?"":L})]})}),(0,b.jsxs)(l.JX,{md:"12",className:"border rounded rounded-4 p-2 mx-2",children:[(0,b.jsx)("h6",{children:"Source"}),(0,b.jsxs)(l.X2,{children:[(0,b.jsx)(l.JX,{md:"4",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsxs)(l.__,{for:"source_name",children:["Name ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsx)(l.II,{bsSize:"sm",id:"source_name",name:"source_name",type:"text",required:!0})]})}),(0,b.jsx)(l.JX,{md:"4",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsx)(l.__,{for:"source_position",children:"Position"}),(0,b.jsx)(l.II,{bsSize:"sm",id:"source_position",name:"source_position",type:"text"})]})}),(0,b.jsx)(l.JX,{md:"4",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsx)(l.__,{for:"source_office",children:"Office"}),(0,b.jsx)(l.II,{bsSize:"sm",id:"source_office",name:"source_office",type:"text"})]})})]})]}),(0,b.jsx)(l.JX,{md:"12",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsxs)(l.__,{for:"subject",children:["Subject ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsx)(l.II,{bsSize:"sm",id:"subject",name:"subject",type:"textarea"})]})}),(0,b.jsx)(l.JX,{md:"6",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsxs)(l.__,{for:"date_received",children:["Date Received ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsx)(l.II,{bsSize:"sm",id:"date_received",name:"date_received",type:"date",required:!0})]})}),(0,b.jsx)(l.JX,{md:"6",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsxs)(l.__,{for:"urgency",children:["Urgency ",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsxs)(l.II,{bsSize:"sm",id:"urgency",name:"urgency",type:"select",required:!0,children:[(0,b.jsx)("option",{value:"Regular",children:"Regular"}),(0,b.jsx)("option",{value:"Rush",children:"Rush"}),(0,b.jsx)("option",{value:"OMG",children:"OMG"})]})]})}),(0,b.jsx)(l.JX,{md:"6",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsxs)(l.__,{for:"scanned",children:["Scanned Copies",(0,b.jsx)("span",{className:"text-danger",children:"*"})]}),(0,b.jsx)(l.II,{onChange:q,bsSize:"sm",id:"scanned",name:"scanned",type:"file",required:!0,multiple:!0,accept:"image/*",invalid:R.scanned}),(0,b.jsx)(l.AG,{children:"File too large. Maximum is 25mb."}),(0,b.jsx)(l.R9,{children:"MULTIPLE FILES ALLOWED 25mb MAX (PNG, JPG, JPEG ONLY)"})]})}),(0,b.jsx)(l.JX,{md:"6",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsx)(l.__,{for:"attachments",children:"Attachments"}),(0,b.jsx)(l.II,{onChange:q,bsSize:"sm",id:"attachments",name:"attachments",type:"file",multiple:!0,invalid:R.attachments,accept:".xlsx,.xls,image/*,.doc, .docx,.ppt, .pptx,.txt,.pdf"}),(0,b.jsx)(l.AG,{children:"File too large. Maximum is 25mb."}),(0,b.jsx)(l.R9,{children:"MULTIPLE FILES ALLOWED 25mb MAX (PDF, DOCX, PPTX, XLSX, JPG, JPEG, PNG  ONLY)"})]})}),(0,b.jsx)(l.JX,{md:"12",children:(0,b.jsxs)(l.cw,{children:[(0,b.jsx)(l.__,{for:"other_remarks",children:"Other Remarks"}),(0,b.jsx)(l.II,{bsSize:"sm",id:"other_remarks",name:"other_remarks",type:"textarea"})]})}),(0,b.jsxs)("div",{className:"d-flex justify-content-center mt-2",children:[(0,b.jsx)(l.zx,{color:"secondary",className:"me-2",onClick:B,disabled:N,children:"Save as draft"}),(0,b.jsx)(l.zx,{type:"reset",className:"me-2",children:"Reset"}),(0,b.jsx)(l.zx,{color:"success",type:"submit",disabled:N,children:w?(0,b.jsx)(l.$j,{color:"light"}):"Add"})]})]})]})})}}}]);
//# sourceMappingURL=456.26dc953c.chunk.js.map