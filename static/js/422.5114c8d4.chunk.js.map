{"version":3,"file":"static/js/422.5114c8d4.chunk.js","mappings":"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","sources":["Helpers/portal_helpers.js","Pages/DTS/Analytics/AnalyticsCharts.jsx","Pages/DTS/Analytics/AnalyticsTablePerDiv.jsx","Pages/DTS/Analytics/Analytics.jsx"],"sourcesContent":["/*\r\n  Portal helper functions\r\n*/\r\nexport const checkPermission = (userPermissions, allowedPermissions) => {\r\n    return userPermissions.includes(allowedPermissions);\r\n}","import React, { useEffect, useState } from \"react\";\r\nimport { Chart } from \"react-google-charts\";\r\nimport { Card, CardBody, Container, Spinner } from \"reactstrap\";\r\nimport styled from \"styled-components\";\r\nimport {\r\n  BsFillEnvelopeFill,\r\n  BsFillClockFill,\r\n  BsFillCheckCircleFill,\r\n} from \"react-icons/bs\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { checkPermission } from \"../../../Helpers/portal_helpers\";\r\nimport { useSelector } from \"react-redux\";\r\n\r\nconst StyledCard = styled(Card)`\r\n  width: 300px !important;\r\n  .card-body {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n  }\r\n`;\r\n\r\nconst AnalyticsCharts = ({ analytics, analyticsRef }) => {\r\n  const [chartData, setChartData] = useState([]);\r\n  const { userPermissions } = useSelector((state) => state.roles);\r\n  const { role_name } = useSelector((state) => state.user.user);\r\n  useEffect(() => {\r\n    const newData = analytics.filter((data) => data.active);\r\n    setChartData(newData);\r\n  }, [analytics]);\r\n\r\n  const options = {\r\n    title:\r\n      chartData.length !== 0 && chartData[0].office_code + \": Pending Vs Completed\",\r\n    is3D: true,\r\n    slices: [{ color: \"#FFC107\" }, { color: \"#28A745\" }],\r\n  };\r\n  // console.log(chartData)\r\n  return (\r\n    <>\r\n      <Container fluid id=\"export_chart\" ref={analyticsRef} style={{ background: \"#FFF\" }}>\r\n        <Container className=\"d-flex\">\r\n          <StyledCard color=\"light\">\r\n            <CardBody>\r\n              <div\r\n                className=\"me-4 img-fluid rounded-circle d-flex justify-content-center align-items-center\"\r\n                style={{\r\n                  width: \"50px\",\r\n                  height: \"50px\",\r\n                  fontSize: \"24px\",\r\n                  background: \"#e8e8f7\",\r\n                }}\r\n              >\r\n                <BsFillEnvelopeFill className=\"text-primary\" />\r\n              </div>\r\n              <div>\r\n                <h3>{chartData.length !== 0 && chartData[0].total}</h3>\r\n                <span>TOTAL</span>\r\n              </div>\r\n            </CardBody>\r\n          </StyledCard>\r\n          <StyledCard\r\n            color=\"light\"\r\n            className=\"ms-3\"\r\n          >\r\n            <CardBody>\r\n              <div\r\n                className=\"me-4 img-fluid rounded-circle d-flex justify-content-center align-items-center\"\r\n                style={{\r\n                  width: \"50px\",\r\n                  height: \"50px\",\r\n                  fontSize: \"24px\",\r\n                  background: \"#efe7be\",\r\n                }}\r\n              >\r\n                <BsFillClockFill style={{ color: \"#df7905\" }} />\r\n              </div>\r\n              <div>\r\n                <h3>{chartData.length !== 0 && chartData[0].data[1][1]}</h3>\r\n                {(chartData.length !== 0 && chartData[0].data[1][1] === 0) || !checkPermission(userPermissions, 'exportReport') || !role_name.includes('Process') ? (\r\n                  \"PENDING\"\r\n                ) : (\r\n                  <Link\r\n                    to={`/dts/managementOfCommunications/reports/${\r\n                      chartData.length !== 0 && chartData[0].com_ids\r\n                    }`}\r\n                  >\r\n                    PENDING\r\n                  </Link>\r\n                )}\r\n              </div>\r\n            </CardBody>\r\n          </StyledCard>\r\n          <StyledCard color=\"light\" className=\"ms-3\">\r\n            <CardBody>\r\n              <div\r\n                className=\"me-4 img-fluid rounded-circle d-flex justify-content-center align-items-center\"\r\n                style={{\r\n                  width: \"50px\",\r\n                  height: \"50px\",\r\n                  fontSize: \"24px\",\r\n                  background: \"#c6e8d0\",\r\n                }}\r\n              >\r\n                <BsFillCheckCircleFill className=\"text-success\" />\r\n              </div>\r\n              <div>\r\n                <h3>{chartData.length !== 0 && chartData[0].data[2][1]}</h3>\r\n                <span>COMPLETED</span>\r\n              </div>\r\n            </CardBody>\r\n          </StyledCard>\r\n        </Container>\r\n        <Container>\r\n          <Chart\r\n            chartType=\"PieChart\"\r\n            data={chartData.length !== 0 && chartData[0].data}\r\n            options={options}\r\n            width={\"100%\"}\r\n            height={\"400px\"}\r\n            loader={\r\n              <div className=\"d-flex justify-content-center mt-5\">\r\n                <Spinner />\r\n                <span className=\"ms-2\">Loading Chart...</span>\r\n              </div>\r\n            }\r\n          />\r\n        </Container>\r\n      </Container>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default AnalyticsCharts;\r\n","import { act } from \"@testing-library/react\";\r\nimport React, { useState } from \"react\";\r\nimport { useEffect } from \"react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { Table } from \"reactstrap\";\r\nimport { getOffices } from \"../../../features/Portal/officesSlice\";\r\nimport { getUser } from \"../../../features/Portal/userSlice\";\r\nimport { ContentSearch } from \"../../../Layouts/Portal\";\r\n\r\nconst _ = require(\"lodash\");\r\nconst AnalyticsTablePerDiv = ({ setAnalytics, analytics, analyticsData, reports }) => {\r\n  const dispatch = useDispatch();\r\n\r\n  const { offices } = useSelector((state) => state.offices);\r\n  const { user } = useSelector((state) => state.user);\r\n  const [controlledOffices, setOffices] = useState([]);\r\n  const [searchValue, setSearch] = useState(\"\");\r\n\r\n  const onSelectOffice = (e) => {\r\n    const row = e.target;\r\n    const office = row.parentElement.getAttribute(\"data-office\");\r\n\r\n    const updateAnalytics = analyticsData.map((data) => {\r\n      if (office === data.office_code) {\r\n        return {\r\n          data: [\r\n            [\"Category\", \"Count\"],\r\n            [\"Pending Communication\", data.data[1][1]],\r\n            [\"Completed Communication\", data.data[2][1]],\r\n          ],\r\n          total: data.total,\r\n          active: true,\r\n          office_code: data.office_code,\r\n          com_ids: data.com_ids\r\n        };\r\n      } else {\r\n        return {\r\n          data: [\r\n            [\"Category\", \"Count\"],\r\n            [\"Pending Communication\", data.data[1][1]],\r\n            [\"Completed Communication\", data.data[2][1]],\r\n          ],\r\n          total: data.total,\r\n          active: false,\r\n          office_code: data.office_code,\r\n          com_ids: data.com_ids\r\n        };\r\n      }\r\n    });\r\n\r\n    setAnalytics([...updateAnalytics]);\r\n  };\r\n  useEffect(() => {\r\n    dispatch(getOffices());\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    let officesUnderAll = [];\r\n\r\n    let officesUnder = offices.filter((office) => {\r\n      return office.office_under === user.office_code;\r\n    });\r\n\r\n    officesUnderAll = offices\r\n      .filter((office) => {\r\n        return (\r\n          officesUnder\r\n            .map((data) => data.office_code)\r\n            .includes(office.office_under) ||\r\n          office.office_code === user.office_code ||\r\n          office.office_under === user.office_code\r\n        );\r\n      })\r\n      .map((office) => office)\r\n      .filter((office) => office.office_code !== \"ORED\");\r\n\r\n    if (!_.isEmpty(user)) {\r\n      if (user.role_name.includes(\"Process-level\")) {\r\n        setOffices(offices);\r\n      } else {\r\n        // console.log(officesUnderAll)\r\n        setOffices(officesUnderAll);\r\n      }\r\n    }\r\n  }, [offices, user]);\r\n\r\n  useEffect(() => {\r\n    const offices = controlledOffices.map(data => data.office_code);\r\n\r\n    const analyticsPerOffice = analytics.filter(data => offices.includes(data.office_code)).map((analytics_data, index) => {\r\n        return {\r\n        data: [\r\n          [\"Category\", \"Count\"],\r\n          [\"Pending Communication\", analytics_data.total - analytics_data.completed],\r\n          [\"Completed Communication\", analytics_data.completed],\r\n        ],\r\n        total: analytics_data.total,\r\n        active:\r\n          index === 0 &&\r\n          !_.isEmpty(user) &&\r\n          !user.role_name.includes(\"Process-level\"),\r\n        office_code: analytics_data.office_code,\r\n        com_ids: analytics_data.com_ids\r\n      };\r\n    })\r\n\r\n    if (!_.isEmpty(user) && user.role_name.includes(\"Process-level\")) {\r\n      const pending = reports.filter((rep) => {\r\n        return _.isEmpty(rep.action_taken);\r\n      }).length;\r\n\r\n      const completed = reports.filter((rep) => {\r\n        return !_.isEmpty(rep.action_taken);\r\n      }).length;\r\n\r\n      analyticsPerOffice.unshift({\r\n        data: [\r\n          [\"Category\", \"Count\"],\r\n          [\"Pending Communication\", pending],\r\n          [\"Completed Communication\", completed],\r\n        ],\r\n        total: pending + completed,\r\n        active: true,\r\n        office_code: \"DA RFO2\",\r\n        office_group: null,\r\n        com_ids: 'all'\r\n      });\r\n    }\r\n    setAnalytics([...analyticsPerOffice]);\r\n    // console.log(analyticsData)\r\n  }, [offices]);\r\n  const analyticsPerOffice = analyticsData\r\n    .filter((data) => !_.isEmpty(data))\r\n    .filter((data) =>\r\n      data.office_code.toLowerCase().includes(searchValue.toLowerCase())\r\n    )\r\n    .map((item, index) => {\r\n      return (\r\n        <tr\r\n          className={item.active ? \"table-dark\" : null}\r\n          data-office={item.office_code}\r\n          onClick={onSelectOffice}\r\n          key={`${index}`}\r\n        >\r\n          <td key={`col_1_${index}`}>{item.office_code}</td>\r\n          <td key={`col_2_${index}`}>{item.data[1][1]}</td>\r\n          <td key={`col_3_${index}`}>{item.data[2][1]}</td>\r\n          <td key={`col_4_${index}`}>{item.total}</td>\r\n        </tr>\r\n      );\r\n    });\r\n\r\n  const onSearchValueChange = (e) => {\r\n    setSearch(e.target.value);\r\n  };\r\n  const clearSearch = (e) => {\r\n    setSearch(\"\");\r\n  };\r\n\r\n  return (\r\n    <div style={{ overflowY: \"auto\", height: \"80vh\" }}>\r\n      <ContentSearch\r\n        placeholder={\"Search Office\"}\r\n        searchValue={searchValue}\r\n        onSearchValueChange={onSearchValueChange}\r\n        clearSearch={clearSearch}\r\n      />\r\n      <br />\r\n      <Table hover bordered striped>\r\n        <thead>\r\n          <tr>\r\n            <th>OFFICE</th>\r\n            <th>PENDING</th>\r\n            <th>COMPLETED</th>\r\n            <th>TOTAL</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>{analyticsPerOffice}</tbody>\r\n      </Table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AnalyticsTablePerDiv;\r\n","// Analytics Page\r\nimport React, { useEffect } from \"react\";\r\nimport { Col, Container, Row } from \"reactstrap\";\r\nimport { useSelector, useDispatch } from \"react-redux\";\r\nimport { getAnalytics, getReport } from \"../../../features/dts/reports/reportSlice\";\r\nimport { ContentLoader, IconatedButton } from \"../../../Layouts/Portal\";\r\nimport AnalyticsCharts from \"./AnalyticsCharts\";\r\nimport AnalyticsTablePerDiv from \"./AnalyticsTablePerDiv\";\r\nimport { useState } from \"react\";\r\nimport { BsDownload, BsPrinter } from \"react-icons/bs\";\r\nimport moment from \"moment\";\r\nimport * as htmlToImage from 'html-to-image';\r\nimport { useReactToPrint } from \"react-to-print\";\r\nimport { useRef } from \"react\";\r\n\r\nconst _ = require(\"lodash\");\r\n \r\nconst Analytics = () => {\r\n  const { analytics, errorMessage, isLoading, reports } = useSelector(\r\n    (state) => state.reports\r\n  );\r\n  const analyticsRef = useRef();\r\n  const [analyticsData, setAnalytics] = useState([\r\n    {\r\n      data: [\r\n        [\"Category\", \"Count\"],\r\n        [\"Pending Communication\", reports.filter((rep) => {\r\n          return _.isEmpty(rep.action_taken);\r\n        }).length],\r\n        [\"Completed Communication\", reports.filter((rep) => {\r\n          return !_.isEmpty(rep.action_taken);\r\n        }).length],\r\n      ],\r\n      active: true,\r\n      office_code: 'DA RFO2',\r\n      com_ids: 'all'\r\n    },\r\n  ]);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const saveCanvas = () => {  \r\n    htmlToImage.toPng(document.getElementById('export_chart'))\r\n    .then(function (dataUrl) {\r\n        const link = document.createElement('a')\r\n        link.download = 'analytics_chart_' + moment().format()\r\n        link.href = dataUrl\r\n        link.click()\r\n    });\r\n  }\r\n\r\n  const handlePrintAnalytics = useReactToPrint({\r\n    content: () => document.getElementById('export_chart'),\r\n    pageStyle: 'print',\r\n    documentTitle: 'Analytics Chart'\r\n  })\r\n\r\n  useEffect(() => {\r\n    dispatch(getReport());\r\n    dispatch(getAnalytics());\r\n  }, [dispatch]);\r\n\r\n  \r\n  return (\r\n    <ContentLoader isLoading={isLoading} errorMessage={errorMessage}>\r\n      <Container>\r\n        <br />\r\n        <div className=\"d-flex\">\r\n          <h3>Analytics</h3>\r\n          <div className=\"d-flex align-items-center ms-auto\">\r\n            <IconatedButton name='Print Chart' color='success' outline icon={<BsPrinter />} className='me-2' onClick={handlePrintAnalytics} />\r\n            <IconatedButton name='Export Chart' outline icon={<BsDownload />} onClick={saveCanvas} />\r\n          </div>\r\n        </div>\r\n        <br />\r\n        <Row>\r\n          <Col md=\"4\">\r\n            <AnalyticsTablePerDiv setAnalytics={setAnalytics} analytics={analytics} analyticsData={analyticsData} reports={reports} />\r\n          </Col>\r\n          <Col md=\"8\">\r\n            <AnalyticsCharts\r\n              analytics={analyticsData}\r\n              analyticsRef={analyticsRef}\r\n            />\r\n          </Col>\r\n        </Row>\r\n      </Container>\r\n    </ContentLoader>\r\n  );\r\n};\r\n\r\nexport default Analytics;\r\n"],"names":["checkPermission","userPermissions","allowedPermissions","includes","StyledCard","styled","Card","analytics","analyticsRef","useState","chartData","setChartData","useSelector","state","roles","role_name","user","useEffect","newData","filter","data","active","options","title","length","office_code","is3D","slices","color","fluid","id","ref","style","background","className","width","height","fontSize","total","to","com_ids","chartType","loader","_","require","setAnalytics","analyticsData","reports","dispatch","useDispatch","offices","controlledOffices","setOffices","searchValue","setSearch","onSelectOffice","e","office","target","parentElement","getAttribute","updateAnalytics","map","getOffices","officesUnderAll","officesUnder","office_under","isEmpty","analyticsPerOffice","analytics_data","index","completed","pending","rep","action_taken","unshift","office_group","toLowerCase","item","onClick","overflowY","placeholder","onSearchValueChange","value","clearSearch","hover","bordered","striped","errorMessage","isLoading","useRef","handlePrintAnalytics","useReactToPrint","content","document","getElementById","pageStyle","documentTitle","getReport","getAnalytics","name","outline","icon","htmlToImage","then","dataUrl","link","createElement","download","moment","format","href","click","md"],"sourceRoot":""}