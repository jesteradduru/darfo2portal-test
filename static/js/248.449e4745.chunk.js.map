{"version":3,"file":"static/js/248.449e4745.chunk.js","mappings":"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","sources":["Pages/DTS/ViewCommunication/ViewCommunication.jsx"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport {\r\n  Container,\r\n  Badge,\r\n  Card,\r\n  CardBody,\r\n  CardHeader,\r\n  CardFooter,\r\n} from \"reactstrap\";\r\nimport {\r\n  AttachmentsContainer,\r\n  EditCommunicationModal,\r\n  ImageGallery,\r\n  NextTaskButton,\r\n} from \"../../../Layouts/DTS\";\r\nimport moment from \"moment\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport {\r\n  decrementTaskCounter,\r\n  getCommunication,\r\n} from \"../../../features/dts/tasks/tasksSlice\";\r\nimport {\r\n  Confirmation,\r\n  ContentLoader,\r\n  IconatedButton,\r\n  RequirePermission,\r\n} from \"../../../Layouts/Portal\";\r\nimport {\r\n  BsChevronLeft,\r\n  BsPencilFill,\r\n  BsPrinter,\r\n  BsTrashFill,\r\n} from \"react-icons/bs\";\r\nimport { seenCommunication } from \"../../../features/dts/inbox/inboxSlice\";\r\nimport { useState } from \"react\";\r\nimport { discardDraft } from \"../../../features/dts/drafts/draftsSlice\";\r\nimport { getAttachments, getScanned } from \"../../../Helpers/dts_helpers\";\r\nimport { useReactToPrint } from \"react-to-print\";\r\nconst _ = require(\"lodash\");\r\n\r\nconst ViewCommunication = () => {\r\n  const { com_id, inbox_id } = useParams();\r\n  const { viewCommunicationData, isLoading, errorMessage } = useSelector(\r\n    (state) => state.tasks\r\n  );\r\n  const { user } = useSelector((state) => state.user);\r\n  const dispatch = useDispatch();\r\n  const navigate = useNavigate();\r\n  const [isOpenConfirm, setOpenConfirm] = useState(false)\r\n\r\n  useEffect(() => {\r\n    dispatch(getCommunication(com_id));\r\n    dispatch(seenCommunication(inbox_id));\r\n  }, [dispatch, com_id]);\r\n\r\n  const {\r\n    com_controlNo,\r\n    com_source_name,\r\n    com_source_position,\r\n    com_source_office,\r\n    com_subject,\r\n    com_dateCreated,\r\n    com_other_remarks,\r\n    // class_name,\r\n    // cat_name,\r\n    com_urgency,\r\n    com_due_date,\r\n    scanned = [],\r\n    attachments = [],\r\n    employee = {},\r\n  } = viewCommunicationData;\r\n  const handlePrintImages = useReactToPrint({\r\n    content: () => {\r\n      const wrapper = document.createElement(\"div\");\r\n      const scannedCopies = getScanned(scanned);\r\n\r\n      scannedCopies.forEach((scan) => {\r\n        const img = document.createElement(\"img\");\r\n        img.setAttribute(\"src\", scan.src);\r\n        img.setAttribute(\"class\", \"img-fluid\");\r\n        wrapper.appendChild(img);\r\n      });\r\n\r\n      return wrapper;\r\n    },\r\n    pageStyle: \"print\",\r\n    documentTitle: \"scanned\",\r\n  });\r\n\r\n  const [isEditModalOpen, toggleEditModal] = useState(false);\r\n\r\n  const onDeleteCommunication = async () => {\r\n    if (window.confirm(\"Are you sure you want to delete this communication?\")) {\r\n      const res = await dispatch(discardDraft(com_id));\r\n      if (res.payload === \"succesfully deleted\") {\r\n        console.log(\"Communication has been deleted\");\r\n        navigate(\"/dts/managementOfCommunications/inbox\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const EditDelete = ({ className }) => {\r\n    return (\r\n      <div className={className}>\r\n        <RequirePermission allowedPermissions={\"editCommunication\"}>\r\n          <IconatedButton\r\n            color=\"success\"\r\n            size=\"sm\"\r\n            icon={<BsPencilFill />}\r\n            onClick={() => {\r\n              toggleEditModal(!isEditModalOpen);\r\n            }}\r\n          />\r\n        </RequirePermission>\r\n        <RequirePermission allowedPermissions={\"deleteCommunication\"}>\r\n          <IconatedButton\r\n            icon={<BsTrashFill />}\r\n            color=\"danger\"\r\n            size=\"sm\"\r\n            className=\"ms-1\"\r\n            onClick={onDeleteCommunication}\r\n          />\r\n        </RequirePermission>\r\n      </div>\r\n    );\r\n  };\r\n  const UrgencyBadge = () => {\r\n    switch(com_urgency){\r\n      case 'OMG':\r\n        return <Badge color=\"danger\">OMG</Badge> \r\n      case 'Rush':\r\n        return <Badge color=\"warning\">Rush</Badge>\r\n      default:\r\n        return <Badge color=\"secondary\">Regular</Badge>\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Container\r\n      className=\"py-3\"\r\n    >\r\n      {!_.isEmpty(viewCommunicationData) && (\r\n        <EditCommunicationModal\r\n          comData={viewCommunicationData}\r\n          isModalOpen={isEditModalOpen}\r\n          toggleModal={toggleEditModal}\r\n        />\r\n      )}\r\n      <ContentLoader isLoading={isLoading} errorMessage={errorMessage}>\r\n        <Confirmation isOpen={isOpenConfirm} />\r\n        <Card>\r\n          <CardHeader className=\"d-flex flex-column\">\r\n            <div className=\"d-flex justify-content-end\">\r\n              <EditDelete className={\"d-flex d-sm-none\"} />\r\n            </div>\r\n            <div className=\"d-flex justify-content-between\">\r\n              <h4>{com_controlNo}</h4>\r\n              <EditDelete className=\"d-none d-sm-flex\" />\r\n            </div>\r\n            <div>\r\n              <UrgencyBadge />\r\n              {!_.isNull(com_due_date) && (\r\n                <Badge color=\"info\" className=\"ms-1\">\r\n                  Due Date: {moment(com_due_date).format(\"dddd, MMMM DD, YYYY\")}\r\n                </Badge>\r\n              )}\r\n              <i className=\"text-secondary d-block\">\r\n                Created by{\" \"}\r\n                {`${employee.emp_firstname} ${employee.emp_lastname}`} -{\" \"}\r\n                {moment(com_dateCreated).format(\"DD/MM/YYYY\")}\r\n              </i>\r\n            </div>\r\n          </CardHeader>\r\n          <CardBody>\r\n            <h4 className=\"text-info\">{com_subject}</h4>\r\n            {(user.role_name?.includes(\"Process-level Approver\") ||\r\n              (user.role_name?.includes(\"Approver\") &&\r\n                user.office_code.includes(\"RTD\"))) && (\r\n              <IconatedButton\r\n                name=\"Print Scanned Copies\"\r\n                className=\"ms-auto d-block\"\r\n                outline\r\n                icon={<BsPrinter />}\r\n                onClick={handlePrintImages}\r\n              />\r\n            )}\r\n\r\n            <ImageGallery\r\n              title={\"Scanned Copies\"}\r\n              images={getScanned(scanned)}\r\n            />\r\n            <br />\r\n            <AttachmentsContainer attachments={getAttachments(attachments)} />\r\n            <hr />\r\n\r\n            <div className=\"p-2\">\r\n              <span className=\"lead\">Other Remarks</span>\r\n              <p>{com_other_remarks}</p>\r\n            </div>\r\n          </CardBody>\r\n          <CardFooter>\r\n            <div>\r\n              <span>Source: </span>\r\n              <u>\r\n                <strong>{com_source_name}</strong>\r\n                {!_.isEmpty(com_source_position) && (\r\n                  <span>, {com_source_position}</span>\r\n                )}\r\n                {!_.isEmpty(com_source_office) && (\r\n                  <span>, {com_source_office}</span>\r\n                )}\r\n              </u>\r\n            </div>\r\n          </CardFooter>\r\n        </Card>\r\n        <div className=\"d-flex justify-content-between mt-2\">\r\n          <IconatedButton\r\n            size=\"md\"\r\n            color=\"primary\"\r\n            name=\"Back\"\r\n            icon={<BsChevronLeft />}\r\n            onClick={() => {\r\n              navigate(-1);\r\n              dispatch(decrementTaskCounter());\r\n            }}\r\n          />\r\n          <NextTaskButton />\r\n        </div>\r\n      </ContentLoader>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default ViewCommunication;\r\n"],"names":["_","require","useParams","com_id","inbox_id","useSelector","state","tasks","viewCommunicationData","isLoading","errorMessage","user","dispatch","useDispatch","navigate","useNavigate","useState","isOpenConfirm","useEffect","getCommunication","seenCommunication","com_controlNo","com_source_name","com_source_position","com_source_office","com_subject","com_dateCreated","com_other_remarks","com_urgency","com_due_date","scanned","attachments","employee","handlePrintImages","useReactToPrint","content","wrapper","document","createElement","getScanned","forEach","scan","img","setAttribute","src","appendChild","pageStyle","documentTitle","isEditModalOpen","toggleEditModal","onDeleteCommunication","window","confirm","discardDraft","payload","console","log","EditDelete","className","allowedPermissions","color","size","icon","onClick","UrgencyBadge","isEmpty","comData","isModalOpen","toggleModal","isOpen","isNull","moment","format","emp_firstname","emp_lastname","role_name","includes","office_code","name","outline","title","images","getAttachments","decrementTaskCounter"],"sourceRoot":""}